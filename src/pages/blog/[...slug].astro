---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import GutterColumn from '../../components/GutterColumn.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
const formattedDate = post.data.date.toLocaleDateString('en-US', {
  month: 'long',
  day: 'numeric',
  year: 'numeric',
}).toLowerCase();
---

<BaseLayout title={`${post.data.title} — utpal.dev`} description={post.data.description}>
  <GutterColumn />
  <main class="max-w-3xl mx-auto px-6 md:px-0 md:pl-16 pt-16 md:pt-24">
    <article>
      <header class="mb-12">
        <span class="font-mono text-xs block mb-2" style="color: var(--text-secondary);">{formattedDate}</span>
        <h1 class="text-3xl md:text-4xl font-semibold tracking-tight" style="color: var(--text-primary);">{post.data.title}</h1>
        <p class="mt-3 text-sm" style="color: var(--text-secondary);">{post.data.description}</p>
      </header>
      <div class="prose prose-sm max-w-none" style="color: var(--text-primary);">
        <Content />
      </div>
      <div class="mt-12 pt-8 border-t" style="border-color: var(--border);">
        <a href="/blog" class="hover-link font-mono text-sm">← back to all thoughts</a>
      </div>
    </article>
  </main>
</BaseLayout>
